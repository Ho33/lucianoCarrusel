var $=function(e){return document.getElementById(e)},STORE=STORE||{};function funcDelegate(n,t){return function(e){return e=e||window.event,n[t](this,e)}}STORE.namespace=function(e){var n,t=e.split("."),o=STORE;if("STORE"!==t[0])return!1;for(t=t.slice(1),n=0;n<t.length;n+=1)void 0===o[t[n]]&&(o[t[n]]={}),o=o[t[n]];return o},STORE.namespace("STORE.DOMObjectLook"),STORE.DOMObjectLook=function(e){this._element=$(e),this._element&&(this._element.onmouseover=funcDelegate(this,"customOnMouseOver"),this._element.onmouseout=funcDelegate(this,"customOnMouseOut"))},STORE.DOMObjectLook.prototype.customOnMouseOver=function(e,n){e.style.cursor="help",e.style.color="olive",e.style.fontSize="2em",e.style.background="#EAEDEE",e.style.borderRadius="25px 25px 25px 25px",e.className="boton s9"},STORE.DOMObjectLook.prototype.customOnMouseOut=function(e,n){e.style.cursor="pointer",e.style.color="#88B3BB",e.style.fontSize="1em",e.style.borderRadius="0px 0px 0px 0px",e.style.background="",e.className="boton s12"},STORE.namespace("STORE.Ajax"),function(){"use strict";STORE.Ajax={READY_STATE_UNINITIALIZED:0,READY_STATE_LOADING:1,READY_STATE_LOADED:2,READY_STATE_INTERACTIVE:3,READY_STATE_COMPLETE:4},STORE.Ajax.CargadorContenidos=function(e,n,t,o){this.url=e,this.req=null,this.json=t||"",this.onload=n,this.onerror=o||this.defaultError,this.cargaContenidoXML(e)},STORE.Ajax.CargadorContenidos.prototype={cargaContenidoXML:function(e){if(window.XMLHttpRequest?this.req=new XMLHttpRequest:window.ActiveXObject&&(this.req=new ActiveXObject("Microsoft.XMLHTTP")),this.req)try{var n=this;this.req.onreadystatechange=function(){n.onReadyState.call(n)},this.req.open("POST",e,!0),this.req.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),this.req.send("json="+this.json)}catch(e){this.onerror.call(this)}},onReadyState:function(){var e=this.req;if(e.readyState==STORE.Ajax.READY_STATE_COMPLETE){var n=e.status;200==n||0==n?this.onload.call(this):this.onerror.call(this)}},defaultError:function(){alert("Se ha producido un error al obtener los datos\n\nreadyState:"+this.req.readyState+"\nstatus: "+this.req.status+"\nheaders: "+this.req.getAllResponseHeaders())}}}(window),function(){var n=new STORE.Ajax.CargadorContenidos("/getcp",function(){var e=JSON.parse(n.req.responseText);createBBDD(e)})}();var createBBDD=function(o){window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange,window.indexedDB||window.alert("Su navegador no soporta una versión estable de indexedDB. Tal y como las características no serán validas");var a=null,e=indexedDB.open("home",1);e.onerror=function(e){alert("Fallo en la apertura: "+e.target.message)},e.onupgradeneeded=function(e){var n=(a=e.target.result).createObjectStore("postalCode",{keyPath:"idCp",autoIncrement:!0});n.createIndex("postalCodeIndex","postalCode",{unique:!1}),n.transaction.oncomplete=function(e){var n=a.transaction("postalCode","readwrite").objectStore("postalCode");for(var t in o)n.add(o[t])},alert("Creada y completada postalCode")}};STORE.namespace("STORE.getCityByCp"),STORE.getCityByCp=function(r){return new Promise(function(t,o){window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange,window.indexedDB||window.alert("Su navegador no soporta una versión estable de indexedDB. Tal y como las características no serán validas");var a=null,e=indexedDB.open("home",1);e.onerror=function(e){alert("Fallo en la apertura: "+e.target.message)},e.onsuccess=function(e){a=e.target.result;var n=IDBKeyRange.only(r);a.transaction(["postalCode"],"readwrite").objectStore("postalCode").index("postalCodeIndex").openCursor(n).onsuccess=function(e){var n=e.target.result;n?t(n.value.municipality):($("cp").style.background="red",o("No está error code:"))}}})};